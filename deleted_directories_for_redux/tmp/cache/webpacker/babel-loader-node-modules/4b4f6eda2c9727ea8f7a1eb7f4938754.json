{"ast":null,"code":"function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport * as THREE from 'three';\nimport { GLTFLoader } from '../gltf/jsm/loaders/GLTFLoader.js';\n\nvar GltfLoadAnimateObject =\n/*#__PURE__*/\nfunction () {\n  function GltfLoadAnimateObject() {\n    _classCallCheck(this, GltfLoadAnimateObject);\n  }\n\n  _createClass(GltfLoadAnimateObject, [{\n    key: \"addObject\",\n    value: function addObject(megaOsGltfModelId) {\n      var promise = new Promise(function (resolve, reject) {\n        this.addObjectInner(megaOsGltfModelId, resolve, reject);\n      });\n      return promise;\n    }\n  }, {\n    key: \"addObjectInner\",\n    value: function addObjectInner() {\n      var loadingManager = new THREE.LoadingManager();\n\n      loadingManager.getHandler = function (arg) {\n        console.log(arg);\n      };\n\n      loadingManager.setURLModifier(function (url) {\n        console.log(url);\n        var regex = /\\/gltf_models\\/4/g;\n\n        if (!url.match(regex)) {\n          url = url.replace('/gltf_models/', '/gltf_models/4/');\n        }\n\n        console.log(url);\n        return url;\n      });\n      var loader = new GLTFLoader(loadingManager); // manager.addHandler( /\\.tga$/i, new TGALoader() );\n\n      loader.load('/gltf_models/4.gltf', function (gltf) {\n        // gltf.scene.position.y = 0.5;\n        var object = gltf.scene;\n        window.mainObject = object;\n        var animations = gltf.animations;\n        console.log(animations.length);\n\n        if (animations && animations.length) {\n          mixer = new THREE.AnimationMixer(object);\n\n          for (var i = 0; i < animations.length; i++) {\n            var animation = animations[i];\n            var action = mixer.clipAction(animation);\n            action.play();\n          }\n        }\n\n        scene.add(object);\n        console.log(object);\n        resolve(object);\n      }, // called while loading is progressing\n      function (xhr) {\n        console.log(xhr.loaded / xhr.total * 100 + '% loaded');\n      }, // called when loading has errors\n      function (error) {\n        console.log('An error happened');\n        console.log(error);\n        reject(error);\n      });\n    }\n  }]);\n\n  return GltfLoadAnimateObject;\n}();\n\nexport { GltfLoadAnimateObject as default };","map":{"version":3,"sources":["/Users/lemonandroid/Banal Dropbox/random/mega-os/ezii-os/app/javascript/packs/eZii-bricklayer-game/gltf-load-animated-object.js"],"names":["THREE","GLTFLoader","GltfLoadAnimateObject","megaOsGltfModelId","promise","Promise","resolve","reject","addObjectInner","loadingManager","LoadingManager","getHandler","arg","console","log","setURLModifier","url","regex","match","replace","loader","load","gltf","object","scene","window","mainObject","animations","length","mixer","AnimationMixer","i","animation","action","clipAction","play","add","xhr","loaded","total","error"],"mappings":";;;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AAEA,SAASC,UAAT,QAA2B,mCAA3B;;IAGqBC,qB;;;;;;;;;8BACVC,iB,EAAmB;AAC5B,UAAIC,OAAO,GAAG,IAAIC,OAAJ,CAAY,UAASC,OAAT,EAAkBC,MAAlB,EAA0B;AACnD,aAAKC,cAAL,CAAoBL,iBAApB,EAAuCG,OAAvC,EAAgDC,MAAhD;AACA,OAFa,CAAd;AAIA,aAAOH,OAAP;AACA;;;qCAEgB;AAChB,UAAIK,cAAc,GAAG,IAAIT,KAAK,CAACU,cAAV,EAArB;;AAEAD,MAAAA,cAAc,CAACE,UAAf,GAA4B,UAASC,GAAT,EAAc;AAAEC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AAAkB,OAA9D;;AAEAH,MAAAA,cAAc,CAACM,cAAf,CAA+B,UAAEC,GAAF,EAAW;AACzCH,QAAAA,OAAO,CAACC,GAAR,CAAYE,GAAZ;AACA,YAAIC,KAAK,GAAI,mBAAb;;AAEA,YAAG,CAAED,GAAG,CAACE,KAAJ,CAAUD,KAAV,CAAL,EAAwB;AACvBD,UAAAA,GAAG,GAAGA,GAAG,CAACG,OAAJ,CAAY,eAAZ,EAA6B,iBAA7B,CAAN;AACA;;AACDN,QAAAA,OAAO,CAACC,GAAR,CAAYE,GAAZ;AAEA,eAAOA,GAAP;AAEA,OAXD;AAaA,UAAII,MAAM,GAAG,IAAInB,UAAJ,CAAeQ,cAAf,CAAb,CAlBgB,CAoBhB;;AAEAW,MAAAA,MAAM,CAACC,IAAP,CAAa,qBAAb,EAAoC,UAAWC,IAAX,EAAkB;AACrD;AAEA,YAAIC,MAAM,GAAGD,IAAI,CAACE,KAAlB;AACAC,QAAAA,MAAM,CAACC,UAAP,GAAoBH,MAApB;AACA,YAAII,UAAU,GAAGL,IAAI,CAACK,UAAtB;AAEAd,QAAAA,OAAO,CAACC,GAAR,CAAYa,UAAU,CAACC,MAAvB;;AAGA,YAAKD,UAAU,IAAIA,UAAU,CAACC,MAA9B,EAAuC;AAClCC,UAAAA,KAAK,GAAG,IAAI7B,KAAK,CAAC8B,cAAV,CAA0BP,MAA1B,CAAR;;AACA,eAAM,IAAIQ,CAAC,GAAG,CAAd,EAAiBA,CAAC,GAAGJ,UAAU,CAACC,MAAhC,EAAwCG,CAAC,EAAzC,EAA+C;AAC9C,gBAAIC,SAAS,GAAGL,UAAU,CAAEI,CAAF,CAA1B;AACA,gBAAIE,MAAM,GAAGJ,KAAK,CAACK,UAAN,CAAkBF,SAAlB,CAAb;AACAC,YAAAA,MAAM,CAACE,IAAP;AACA;AACD;;AAGLX,QAAAA,KAAK,CAACY,GAAN,CAAWb,MAAX;AAGAV,QAAAA,OAAO,CAACC,GAAR,CAAYS,MAAZ;AAEAjB,QAAAA,OAAO,CAACiB,MAAD,CAAP;AACA,OA1BD,EA4BA;AACA,gBAAWc,GAAX,EAAiB;AAEhBxB,QAAAA,OAAO,CAACC,GAAR,CAAeuB,GAAG,CAACC,MAAJ,GAAaD,GAAG,CAACE,KAAjB,GAAyB,GAA3B,GAAmC,UAAhD;AACA,OAhCD,EAiCA;AACA,gBAAWC,KAAX,EAAmB;AAElB3B,QAAAA,OAAO,CAACC,GAAR,CAAa,mBAAb;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAa0B,KAAb;AACAjC,QAAAA,MAAM,CAACiC,KAAD,CAAN;AAEA,OAxCD;AA2CA;;;;;;SA1EmBtC,qB","sourcesContent":["import * as THREE from 'three';\n\nimport { GLTFLoader } from '../gltf/jsm/loaders/GLTFLoader.js';\n\n\nexport default class GltfLoadAnimateObject {\n\taddObject(megaOsGltfModelId) {\n\t\tlet promise = new Promise(function(resolve, reject) {\n\t\t\tthis.addObjectInner(megaOsGltfModelId, resolve, reject);\n\t\t});\n\t\n\t\treturn promise;\n\t}\n\t\n\taddObjectInner() {\n\t\tlet loadingManager = new THREE.LoadingManager();\n\t\n\t\tloadingManager.getHandler = function(arg) { console.log(arg) }\n\t\n\t\tloadingManager.setURLModifier( ( url ) => {\n\t\t\tconsole.log(url);\n\t\t\tlet regex =  /\\/gltf_models\\/4/g\n\t\t\n\t\t\tif(!(url.match(regex))) {\n\t\t\t\turl = url.replace('/gltf_models/', '/gltf_models/4/');\n\t\t\t}\n\t\t\tconsole.log(url);\n\t\t\n\t\t\treturn url;\n\n\t\t});\n\t\n\t\tvar loader = new GLTFLoader(loadingManager);\n\t\n\t\t// manager.addHandler( /\\.tga$/i, new TGALoader() );\n\n\t\tloader.load( '/gltf_models/4.gltf', function ( gltf ) {\n\t\t\t// gltf.scene.position.y = 0.5;\n\t\t\n\t\t\tvar object = gltf.scene;\n\t\t\twindow.mainObject = object;\n\t\t\tvar animations = gltf.animations;\t\t\t\t\n\t\t\n\t\t\tconsole.log(animations.length);\n\t\t\n\t\t\n\t\t\tif ( animations && animations.length ) {\n\t\t\t\t\t\t\t\tmixer = new THREE.AnimationMixer( object );\n\t\t\t\t\t\t\t\tfor ( var i = 0; i < animations.length; i ++ ) {\n\t\t\t\t\t\t\t\t\tvar animation = animations[ i ]\n\t\t\t\t\t\t\t\t\tvar action = mixer.clipAction( animation );\n\t\t\t\t\t\t\t\t\taction.play();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\tscene.add( object );\n\t\t\n\t\t\n\t\t\tconsole.log(object);\n\t\t\t\t\t\t\n\t\t\tresolve(object);\n\t\t},\n\n\t\t// called while loading is progressing\n\t\tfunction ( xhr ) {\n\t\t\n\t\t\tconsole.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );\n\t\t},\n\t\t// called when loading has errors\n\t\tfunction ( error ) {\n\n\t\t\tconsole.log( 'An error happened' );\n\t\t\tconsole.log( error );\n\t\t\treject(error);\n\n\t\t}\n\n\t );\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}